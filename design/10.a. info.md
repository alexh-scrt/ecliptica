
## **Key Sections:**

### **1. Encrypted Transaction Format**
- Complete `EncryptedTransaction` structure with threshold time-locked encryption
- Encryption/decryption protocol using Shamir's Secret Sharing
- Payload commitments for tamper detection

### **2. Mempool Data Structures**
- Priority queue with multiple indices (sender/nonce, time-lock, expiry)
- Efficient O(log n) operations for insertion and retrieval
- Bloom filter for deduplication

### **3. Transaction Propagation**
- GossipSub protocol with shard-specific topics
- Message validation and forwarding logic
- Target: <500ms propagation to 95% of network

### **4. DoS Protection**
- Multi-layer rate limiting (per-sender, per-peer, global)
- Token bucket algorithm for burst handling
- Spam detection based on inclusion rates
- Priority penalties for misbehavior

### **5. Mempool Synchronization**
- Peer-to-peer mempool state sync
- Efficient diff-based reconciliation
- Request/response protocol for missing transactions

### **6. Fair Sequencing Service (FSS)**
- Deterministic ordering algorithm (time-lock → fee → first-seen → hash)
- First-seen consensus using validator votes (median timestamp)
- Prevents MEV manipulation of transaction ordering

### **7. Private vs Public Tradeoffs**
- Detailed comparison matrix
- User-configurable privacy levels (Maximum/Balanced/Minimal/Public)
- Latency vs privacy tradeoff analysis

### **8. Performance Benchmarks**
- Real measurements for all operations
- 52,000 tx/s ingestion rate achieved
- Memory usage: 1.7 GB for 100k transactions

### **9. Security Analysis**
- Threat model covering MEV, DoS, privacy leaks
- Privacy leakage analysis (what's revealed vs hidden)
- Timing attack mitigations

